<h2>Actualizar Habilidad</h2>

@if (mensaje()) {
  <p style="color: green;">{{ mensaje() }}</p>
}
@if (error()) {
  <p style="color: red;">{{ error() }}</p>
}

@if (habilidades().length > 0) {
  <label>Selecciona una habilidad:</label>
  <select [ngModel]="seleccionadoId()" (ngModelChange)="seleccionar($event)">
    <option [value]="null">-- Selecciona --</option>
    @for (h of habilidades(); track h.id) {
      <option [value]="h.id">{{ h.nombre }}</option>
    }
  </select>
}

@if (habilidadSeleccionada) {
  <form [formGroup]="form" (ngSubmit)="actualizar()" style="margin-top: 20px;">
    <label>Nombre:</label>
    <input type="text" formControlName="nombre" />

    <label>Daño:</label>
    <input type="number" formControlName="dano" />

    <label>Icono (URL Imgur):</label>
    <input type="text" formControlName="iconoUrl" />
    @if (form.get('iconoUrl')?.errors?.['imgurUrl']) {
      <p style="color: red;">La URL debe ser válida de Imgur</p>
    }

    @if (form.get('iconoUrl')?.valid) {
      <div style="margin-top: 10px;">
        <h4>Vista previa:</h4>
        <img [src]="form.get('iconoUrl')?.value"
             alt="Icono"
             style="max-width: 200px; max-height: 150px; display: block;" />
      </div>
    }

    <label>Personaje (opcional):</label>
    <select formControlName="personajeId">
      <option [value]="null">-- Sin personaje asociado --</option>
      @for (p of personajes(); track p.id) {
        <option [value]="p.id">{{ p.nombre }}</option>
      }
    </select>

    <button type="submit" [disabled]="form.invalid">Actualizar</button>
  </form>
}
